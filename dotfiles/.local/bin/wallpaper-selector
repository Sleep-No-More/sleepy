#!/bin/bash

# Wallpaper selector using rofi and swww
WALLPAPER_DIR="$HOME/.config/hypr/wallpapers"

# Get list of wallpapers
wallpapers=$(ls -1 "$WALLPAPER_DIR" 2>/dev/null | grep -E '\.(png|jpg|jpeg|gif)$')

if [ -z "$wallpapers" ]; then
    notify-send "Wallpaper Selector" "No wallpapers found in $WALLPAPER_DIR"
    exit 1
fi

# Show rofi menu
selected=$(echo "$wallpapers" | rofi -dmenu -p "Select Wallpaper:" -theme-str 'window { width: 50%; }')

if [ -z "$selected" ]; then
    exit 0
fi

wallpaper_path="$WALLPAPER_DIR/$selected"

# Set wallpaper with swww
if swww img "$wallpaper_path" 2>/dev/null; then
    notify-send "Wallpaper Changed" "$selected"
    
    # Update pywal colors if desired (optional)
    # wal -i "$wallpaper_path" &
else
    notify-send "Error" "Failed to set wallpaper"
    exit 1
fi
